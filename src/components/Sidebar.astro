---
import { getCollection } from "astro:content";
import { CATEGORIES } from "../consts/variables";

const posts = await getCollection('post');
const getPostNumByCategory = (categoryId: string) => {
  const filteredPost = posts.filter(post => post.data.category === categoryId);

  return filteredPost.length;
}
const { category } = Astro.params;
console.log(category)
---
<div class="col-md-3 col-lg-2">
  <p>カテゴリ一覧</p>
  <div class="list-group">
    <a 
      href="/UnityContent/"
      aria-current="true"
      class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
    >
      ホームへ
    </a>
    {
      CATEGORIES.map(_category => (
        <a 
          class={`${_category.id === category ? 'active' : ''} list-group-item list-group-item-action d-flex justify-content-between align-items-center`}
          aria-current="true"
          href={`/UnityContent/categories/${_category.id}`}>
          { _category.name }
          <span class="badge bg-primary">{ getPostNumByCategory(_category.id) }</span>
        </a>
      ))
    }
  </div>
</div>